<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Processing Raster Data • voluModel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Processing Raster Data">
<meta property="og:description" content="voluModel">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">voluModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_Introduction.html">1. Introduction to `voluModel`</a>
    </li>
    <li>
      <a href="../articles/2_RasterProcessing.html">2. Processing Raster Data</a>
    </li>
    <li>
      <a href="../articles/3_DataSampling.html">3. Environmental Data Sampling</a>
    </li>
    <li>
      <a href="../articles/4_Visualization.html">4. Visualization Tools</a>
    </li>
    <li>
      <a href="../articles/5_GLMWorkflow.html">5. 3D Niche Modeling with the GLM Algorithm</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hannahlowens/voluModel/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="2_RasterProcessing_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Processing Raster Data</h1>
                        <h4 data-toc-skip class="author">Hannah L. Owens</h4>
                        <h4 data-toc-skip class="author">Carsten Rahbek</h4>
            
            <h4 data-toc-skip class="date">2022-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hannahlowens/voluModel/blob/HEAD/vignettes/2_RasterProcessing.Rmd" class="external-link"><code>vignettes/2_RasterProcessing.Rmd</code></a></small>
      <div class="hidden name"><code>2_RasterProcessing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Naturally, to build 3D distribution models, one needs three-dimensionally structured environmental data. These data may come in the form of interpolated <em>in situ</em> measurements (e.g. <a href="https://www.ncei.noaa.gov/access/world-ocean-atlas-2018/" class="external-link">NOAA’s World Ocean Atlas dataset</a>; Garcia et al. 2018a) or as outputs from climate models, either as stand-alone ocean components or as a component of coupled atmosphere-ocean models (e.g. CCSM3, Collins et al. 2006; HadCM3, Valdes et al. 2017). Typically, these data are organized as a series of horizontal layers that are stacked by depth.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hannahlowens.github.io/voluModel/" class="external-link">voluModel</a></span><span class="op">)</span> <span class="co"># Since this is the package this vignette is about.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rgdal.r-forge.r-project.org" class="external-link">rgdal</a></span><span class="op">)</span> <span class="co"># For vector stuff. Will eventually be replaced with sf.</span></code></pre></div>
<pre><code><span class="co">## Loading required package: sp</span></code></pre>
<pre><code><span class="co">## Please note that rgdal will be retired by the end of 2023,</span>
<span class="co">## plan transition to sf/stars/terra functions using GDAL and PROJ</span>
<span class="co">## at your earliest convenience.</span>
<span class="co">## </span>
<span class="co">## rgdal: version: 1.5-28, (SVN revision 1158)</span>
<span class="co">## Geospatial Data Abstraction Library extensions to R successfully loaded</span>
<span class="co">## Loaded GDAL runtime: GDAL 3.0.4, released 2020/01/28</span>
<span class="co">## Path to GDAL shared files: /usr/share/gdal</span>
<span class="co">## GDAL binary built with GEOS: TRUE </span>
<span class="co">## Loaded PROJ runtime: Rel. 6.3.1, February 10th, 2020, [PJ_VERSION: 631]</span>
<span class="co">## Path to PROJ shared files: /usr/share/proj</span>
<span class="co">## Linking to sp version:1.4-6</span>
<span class="co">## To mute warnings of possible GDAL/OSR exportToProj4() degradation,</span>
<span class="co">## use options("rgdal_show_exportToProj4_warnings"="none") before loading sp or rgdal.</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span> <span class="co"># For raster stuff. Will eventually be replaced with terra.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span> <span class="co"># For data organization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># For supplementary visualization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dnychka/fieldsRPackage" class="external-link">fields</a></span><span class="op">)</span> <span class="co"># For raster interpolation</span></code></pre></div>
<pre><code><span class="co">## Loading required package: spam</span></code></pre>
<pre><code><span class="co">## Spam version 2.8-0 (2022-01-05) is loaded.</span>
<span class="co">## Type 'help( Spam)' or 'demo( spam)' for a short introduction </span>
<span class="co">## and overview of this package.</span>
<span class="co">## Help for individual functions is also obtained by adding the</span>
<span class="co">## suffix '.spam' to the function name, e.g. 'help( chol.spam)'.</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'spam'</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     backsolve, forwardsolve</span></code></pre>
<pre><code><span class="co">## Loading required package: viridis</span></code></pre>
<pre><code><span class="co">## Loading required package: viridisLite</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## Try help(fields) to get started.</span></code></pre>
</div>
<div class="section level2">
<h2 id="data-inputs">Data Inputs<a class="anchor" aria-label="anchor" href="#data-inputs"></a>
</h2>
<p>First, let’s look at a relatively simple environmental variable from the WOA: temperature (Locarnini et al, 2018). These data are supplied by the World Ocean Atlas as point shapefiles; the version supplied here has been cropped between -110 and -40 longitude and between -5 and 50 latitude to make it more memory-efficient. You can download the full dataset via the WOA website. Our first task is to read in the shapefile as a <code>SpatialPointsDataFrame</code>. Note that each row in <code>temperature@data</code> is a set of horizontal coordinates. Each column is a vertical position in the water column. Make sure to check the metadata of the data you use. Different sources may use vertical depth structures.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/woa18_decav_t00mn01_cropped.zip"</span>, 
                  package <span class="op">=</span> <span class="st">"voluModel"</span><span class="op">)</span>,
      exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/temperature"</span><span class="op">)</span>, junkpaths <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html" class="external-link">readOGR</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/temperature/"</span><span class="op">)</span>, 
                       layer <span class="op">=</span><span class="st">"woa18_decav_t00mn01_cropped"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## OGR data source with driver: ESRI Shapefile </span>
<span class="co">## Source: "/tmp/RtmpXZp7Ss/temperature", layer: "woa18_decav_t00mn01_cropped"</span>
<span class="co">## with 2291 features</span>
<span class="co">## It has 102 fields</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/temperature/"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="co"># Specifying "no data" value</span>
<span class="va">temperature</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="va">temperature</span><span class="op">@</span><span class="va">data</span> <span class="op">==</span> <span class="op">-</span><span class="fl">999.999</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="co"># Looking at the dataset</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   SURFACE    d5M   d10M   d15M   d20M   d25M   d30M   d35M   d40M   d45M   d50M</span>
<span class="co">## 1  25.330 25.296 25.265 25.222 25.149 24.958 24.641 24.314 23.894 23.341 22.670</span>
<span class="co">## 2  25.118 25.111 25.091 25.067 24.995 24.855 24.736 24.254 23.779 23.009 22.246</span>
<span class="co">## 3  25.032 24.992 24.978 24.922 24.770 24.594 24.251 23.725 23.081 22.464 21.684</span>
<span class="co">## 4  24.952 24.914 24.835 24.753 24.620 24.389 23.992 23.447 22.884 22.250 21.481</span>
<span class="co">## 5  24.791 24.761 24.726 24.678 24.521 24.243 23.922 23.443 22.812 22.059 21.282</span>
<span class="co">## 6  24.889 24.870 24.823 24.736 24.637 24.426 23.925 23.223 22.521 21.734 20.924</span>
<span class="co">##     d55M   d60M   d65M   d70M   d75M   d80M   d85M   d90M   d95M  d100M  d125M</span>
<span class="co">## 1 21.995 21.350 20.586 19.760 18.922 18.124 17.359 16.725 15.862 15.323 13.823</span>
<span class="co">## 2 21.408 20.541 19.727 18.959 18.067 17.246 16.548 15.957 15.261 14.807 13.659</span>
<span class="co">## 3 20.782 19.916 18.923 18.060 17.330 16.675 16.095 15.637 15.089 14.649 13.639</span>
<span class="co">## 4 20.709 19.780 18.831 17.993 17.236 16.629 15.967 15.570 15.053 14.711 13.609</span>
<span class="co">## 5 20.365 19.491 18.532 17.640 16.934 16.291 15.735 15.210 14.783 14.495 13.665</span>
<span class="co">## 6 20.276 19.532 18.748 17.913 17.053 16.504 15.951 15.385 14.897 14.605 13.736</span>
<span class="co">##    d150M  d175M  d200M  d225M  d250M  d275M  d300M  d325M  d350M  d375M  d400M</span>
<span class="co">## 1 13.228 12.929 12.749 12.561 12.208 11.955 11.688 11.400 10.971 10.506 10.087</span>
<span class="co">## 2 13.240 12.997 12.783 12.580 12.357 12.096 11.777 11.401 10.957 10.493 10.019</span>
<span class="co">## 3 13.278 13.007 12.799 12.580 12.350 12.077 11.774 11.418 11.004 10.536 10.083</span>
<span class="co">## 4 13.207 12.940 12.742 12.532 12.307 12.053 11.766 11.422 10.994 10.537 10.066</span>
<span class="co">## 5 13.286 13.015 12.802 12.597 12.361 12.107 11.802 11.444 11.031 10.555 10.066</span>
<span class="co">## 6 13.320 13.084 12.877 12.665 12.447 12.201 11.904 11.541 11.132 10.646 10.120</span>
<span class="co">##   d425M d450M d475M d500M d550M d600M d650M d700M d750M d800M d850M d900M d950M</span>
<span class="co">## 1 9.581 9.134 8.703 8.514 7.724 7.138 6.644 6.235 5.867 5.545 5.252 4.997 4.762</span>
<span class="co">## 2 9.626 9.199 8.778 8.419 7.750 7.142 6.638 6.224 5.883 5.550 5.249 4.961 4.738</span>
<span class="co">## 3 9.607 9.192 8.769 8.386 7.742 7.147 6.637 6.203 5.827 5.487 5.208 4.966 4.733</span>
<span class="co">## 4 9.597 9.158 8.736 8.344 7.659 7.045 6.561 6.152 5.815 5.503 5.179 4.915 4.691</span>
<span class="co">## 5 9.579 9.161 8.730 8.346 7.688 7.106 6.621 6.185 5.808 5.504 5.197 4.941 4.716</span>
<span class="co">## 6 9.641 9.158 8.749 8.337 7.651 7.088 6.590 6.168 5.804 5.503 5.211 4.964 4.748</span>
<span class="co">##   d1000M d1050M d1100M d1150M d1200M d1250M d1300M d1350M d1400M d1450M d1500M</span>
<span class="co">## 1  4.544  4.357  4.167  3.977  3.822  3.666  3.500  3.384  3.263  3.147  3.037</span>
<span class="co">## 2  4.536  4.372  4.189  3.995  3.776  3.609  3.458  3.334  3.210  3.108  3.032</span>
<span class="co">## 3  4.524  4.320  4.139  3.948  3.774  3.624  3.506  3.380  3.261  3.136  3.024</span>
<span class="co">## 4  4.514  4.331  4.146  3.965  3.750  3.593  3.451  3.325  3.221  3.128  3.028</span>
<span class="co">## 5  4.489  4.288  4.104  3.940  3.747  3.595  3.472  3.339  3.210  3.104  3.001</span>
<span class="co">## 6  4.518  4.312  4.130  3.953  3.788  3.647  3.502  3.365  3.238  3.118  3.006</span>
<span class="co">##   d1550M d1600M d1650M d1700M d1750M d1800M d1850M d1900M d1950M d2000M d2100M</span>
<span class="co">## 1  2.930  2.842  2.741  2.654  2.580  2.504  2.442  2.380  2.332  2.258  2.174</span>
<span class="co">## 2  2.954  2.862  2.764  2.647  2.555  2.472  2.417  2.360  2.301     NA     NA</span>
<span class="co">## 3  2.924  2.827  2.720  2.637  2.567  2.505  2.431  2.365  2.315     NA     NA</span>
<span class="co">## 4  2.908  2.813  2.725  2.649  2.576  2.515  2.461  2.394  2.342     NA     NA</span>
<span class="co">## 5  2.919  2.826  2.731  2.666  2.594  2.527  2.455  2.406  2.353     NA     NA</span>
<span class="co">## 6  2.902  2.805  2.720  2.642  2.565  2.492  2.431  2.373  2.323  2.272     NA</span>
<span class="co">##   d2200M d2300M d2400M d2500M d2600M d2700M d2800M d2900M d3000M d3100M d3200M</span>
<span class="co">## 1  2.107   2.05  1.987  1.914   1.87   1.82  1.766   1.72  1.678   1.65  1.597</span>
<span class="co">## 2     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 3     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 4     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 5     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 6     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">##   d3300M d3400M d3500M d3600M d3700M d3800M d3900M d4000M d4100M d4200M d4300M</span>
<span class="co">## 1  1.583  1.584  1.586     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 2     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 3     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 4     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 5     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 6     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">##   d4400M d4500M d4600M d4700M d4800M d4900M d5000M d5100M d5200M d5300M d5400M</span>
<span class="co">## 1     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 2     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 3     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 4     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 5     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">## 6     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA</span>
<span class="co">##   d5500M</span>
<span class="co">## 1     NA</span>
<span class="co">## 2     NA</span>
<span class="co">## 3     NA</span>
<span class="co">## 4     NA</span>
<span class="co">## 5     NA</span>
<span class="co">## 6     NA</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">land</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"medium"</span>, 
                                    returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">@</span><span class="va">coords</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">temperature</span>, main <span class="op">=</span> <span class="st">"Distribution of voluModel subset of WOA Temperature 2018"</span>,
     pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlim <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land</span>, col <span class="op">=</span> <span class="st">"black"</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/environmental%20data%20loading%20temperature-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What does the WOA depth structure look like?</span>
<span class="va">depths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>
<span class="va">depths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="va">depths</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, pattern <span class="op">=</span> <span class="st">"[d,M]"</span>, replacement <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">depths</span>, pch <span class="op">=</span> <span class="fl">20</span>, main <span class="op">=</span> <span class="st">"Depth Intervals in WOA Temperature Dataset"</span>, xlab <span class="op">=</span> <span class="st">"Depth (m)"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/environmental%20data%20loading%20temperature-2.png" width="700"></p>
<p>Next, we convert temperature into a <code>RasterBrick</code>. While we are at it, we will generate a raster from the deepest value available for each point. While you might call this a “bottom” raster, it is important to note that in some cases, values are not available for the bottom. After the <code>RasterBrick</code> is created, we give it the same depth names as the columns in the <code>SpatialPointsDataFrame</code>. This is important, because <code>voluModel</code> uses these names as z coordinates when handling 3D data. I am using <code><a href="../reference/oneRasterPlot.html">oneRasterPlot()</a></code> from voluModel to visualize the rasters using a uniform, high-contrast asthetic.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Creating a bottom raster from the point shapefile</span>
<span class="va">temperatureBottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bottomRaster.html">bottomRaster</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span>

<span class="co"># Creating a 3D temperature RasterBrick from the point shapefile</span>
<span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterFromXYZ.html" class="external-link">rasterFromXYZ</a></span><span class="op">(</span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">@</span><span class="va">coords</span>,
                                   <span class="va">temperature</span><span class="op">@</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Get names of depths</span>
<span class="va">envtNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[d,M]"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span><span class="op">)</span>
<span class="va">envtNames</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"0"</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">envtNames</span>

<span class="co"># How do these files look?</span>
<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title<span class="op">=</span> <span class="st">"Temperature, surface"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/temperature%20processing-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># R won't let you name the layers numbers only--it pastes an X at the beginning</span>
<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">[[</span><span class="st">"X100"</span><span class="op">]</span><span class="op">]</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title<span class="op">=</span> <span class="st">"Temperature, 100m"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/temperature%20processing-2.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">temperatureBottom</span>,land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title <span class="op">=</span> <span class="st">"Temperature, bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/temperature%20processing-3.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="interpolation">Interpolation<a class="anchor" aria-label="anchor" href="#interpolation"></a>
</h2>
<p>Next, we have a bit of a more complicated example: apparent oxygen utilization (AOU; Garcia et al, 2018b). Apparent oxygen usage is more patchily sampled than temperature (it’s generally measured from instrument casts on research cruises, and the coverage isn’t quite as dense as for temperature).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/woa18_all_A00mn01_cropped.zip"</span>, 
                  package <span class="op">=</span> <span class="st">"voluModel"</span><span class="op">)</span>,
      exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/oxygen"</span><span class="op">)</span>, junkpaths <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co"># do something with the files</span>
<span class="va">oxygen</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html" class="external-link">readOGR</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/oxygen/"</span><span class="op">)</span>, 
                  layer <span class="op">=</span> <span class="st">"woa18_all_A00mn01_cropped"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## OGR data source with driver: ESRI Shapefile </span>
<span class="co">## Source: "/tmp/RtmpXZp7Ss/oxygen", layer: "woa18_all_A00mn01_cropped"</span>
<span class="co">## with 1967 features</span>
<span class="co">## It has 102 fields</span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/oxygen/"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="va">oxygen</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="va">oxygen</span><span class="op">@</span><span class="va">data</span> <span class="op">==</span> <span class="op">-</span><span class="fl">999.999</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">oxygen</span>, main <span class="op">=</span> <span class="st">"Distribution of voluModel subset of WOA AOU 2018"</span>,
     pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlim <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land</span>, col <span class="op">=</span> <span class="st">"black"</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/environmental%20data%20loading%20oxygen-1.png" width="700"></p>
<p>There is a workaround for this, since we can reasonably expect some degree of spatial autocorrelation in apparent oxygen utilization. We use the <code><a href="../reference/interpolateRaster.html">interpolateRaster()</a></code> function to produce statistically-interpolated layers using <code>TPS()</code> from the <code>fields</code> package (this is a thin-plate spline interpolation). Be patient–this step can take a while, although as shown here, I am using the <code>fastTPS()</code> approximation, which only samples from nearby cells to speed things up. Maybe <code>fastTPS()</code> will work ok for your data, maybe it won’t. It depends on the data.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Creating a bottom raster</span>
<span class="va">oxygenBottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bottomRaster.html">bottomRaster</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">)</span>
<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygenBottom</span>,land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title <span class="op">=</span> <span class="st">"Apparent oxygen utilization, bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/interpolate%20oxygen-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oxygenBottomInterpolated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolateRaster.html">interpolateRaster</a></span><span class="op">(</span><span class="va">oxygenBottom</span>, lon.lat <span class="op">=</span> <span class="cn">T</span>, fast <span class="op">=</span> <span class="cn">T</span>, aRange <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co">#Thin plate spline interpolation</span>
<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygenBottomInterpolated</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title <span class="op">=</span> <span class="st">"Apparent oxygen utilization, bottom, interpolated"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/interpolate%20oxygen-2.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Creating a RasterBrick</span>
<span class="va">oxygen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterFromXYZ.html" class="external-link">rasterFromXYZ</a></span><span class="op">(</span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">@</span><span class="va">coords</span>, <span class="va">oxygen</span><span class="op">@</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html" class="external-link">nlayers</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">oxygen</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolateRaster.html">interpolateRaster</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, lon.lat <span class="op">=</span> <span class="cn">T</span>, fast <span class="op">=</span> <span class="cn">T</span>, aRange <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co">#Thin plate spline interpolation</span>
  <span class="va">oxygen</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/mask.html" class="external-link">mask</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">oxygen</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, mask <span class="op">=</span> <span class="va">temperature</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">temperature</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Change names to match temperature</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">envtNames</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">envtNames</span><span class="op">)</span>

<span class="co"># How do these files look?</span>
<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title<span class="op">=</span> <span class="st">"Apparent Oxygen Utilization, surface\ninterpolated"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/interpolate%20oxygen-3.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">[[</span><span class="st">"X100"</span><span class="op">]</span><span class="op">]</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title<span class="op">=</span> <span class="st">"Apparent Oxygen Utilization, 100m\ninterpolated"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/interpolate%20oxygen-4.png" width="700"></p>
<p>You can see from these plots that apparent oxygen utilization is “patchier” than temperature. If you are confident that there should be a strong spatial correlation in a “patchy” data layer, you can also statistically smooth it, again using <code>TPS()</code>, like this:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oxygenSmooth</span> <span class="op">&lt;-</span> <span class="va">oxygen</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html" class="external-link">nlayers</a></span><span class="op">(</span><span class="va">oxygen</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">oxygenSmooth</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smoothRaster.html">smoothRaster</a></span><span class="op">(</span><span class="va">oxygenSmooth</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, lon.lat <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#Thin plate spline interpolation</span>
  <span class="va">oxygenSmooth</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/mask.html" class="external-link">mask</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">oxygenSmooth</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, mask <span class="op">=</span> <span class="va">temperature</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">temperature</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Change names to match temperature</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">oxygenSmooth</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span>

<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygenSmooth</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title<span class="op">=</span> <span class="st">"Apparent Oxygen Utilization, surface\ninterpolated and smoothed"</span><span class="op">)</span>

<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygenSmooth</span><span class="op">[[</span><span class="st">"X100"</span><span class="op">]</span><span class="op">]</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>, 
              title<span class="op">=</span> <span class="st">"Apparent Oxygen Utilization, 100m\ninterpolated and smoothed"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/smooth%20oxygen%20display-1.png" width="700"><img src="2_RasterProcessing_files/figure-html/smooth%20oxygen%20display-2.png" width="700"></p>
<p>Let’s smooth the bottom apparent oxygen utilization while we’re at it.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oxygenSmoothBottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smoothRaster.html">smoothRaster</a></span><span class="op">(</span><span class="va">oxygenBottomInterpolated</span>, lon.lat <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># Not using fastTPS</span>
<span class="va">oxygenSmoothBottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/mask.html" class="external-link">mask</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">oxygenSmoothBottom</span>, 
                                mask <span class="op">=</span> <span class="va">temperature</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, 
                           <span class="va">temperature</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="../reference/oneRasterPlot.html">oneRasterPlot</a></span><span class="op">(</span><span class="va">oxygenSmoothBottom</span>, land <span class="op">=</span> <span class="va">land</span>, landCol <span class="op">=</span> <span class="st">"black"</span>,
     title <span class="op">=</span> <span class="st">"Apparent Oxygen Utilization, bottom, \ninterpolated and smoothed"</span><span class="op">)</span></code></pre></div>
<p><img src="2_RasterProcessing_files/figure-html/bottom%20smoothed%20oxygen-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Collins WD, Bitz CM, Blackmon ML, Bonan GB, Bretherton CS, Carton JA, Chang P, Doney SC, Hack JJ, Henderson TB, Kiehl JT, Large WG, McKenna DS, Santer BD, Smith RD. (2006) The Community Climate System Model Version 3 (CCSM3) Journal of Climate, 19(11), 2122–2143 <a href="https://doi.org/10.1175/jcli3761.1" class="external-link uri">https://doi.org/10.1175/jcli3761.1</a></p>
<p>Garcia HE, Boyer P, Baranova OK, Locarnini RA, Mishonov AV, Grodsky A, Paver CR, Weathers KW, Smolyar IV, Reagan JR, Seidov D, Zweng MM. (2018a). World Ocean Atlas 2018 (A. Mishonov, Ed.). NOAA National Centers for Environmental Information. <a href="https://accession.nodc.noaa.gov/NCEI-WOA18" class="external-link uri">https://accession.nodc.noaa.gov/NCEI-WOA18</a></p>
<p>Garcia HE, Weathers K, Paver CR, Smolyar I, Boyer TP, Locarnini RA, Zweng MM, Mishonov AV, Baranova OK, Seidov D, Reagan JR (2018b). World Ocean Atlas 2018, Volume 3: Dissolved Oxygen, Apparent Oxygen Utilization, and Oxygen Saturation. A Mishonov Technical Ed.; NOAA Atlas NESDIS 83, 38pp.</p>
<p>Locarnini RA, Mishonov AV, Baranova OK, Boyer TP, Zweng MM, Garcia HE, Reagan JR, Seidov D, Weathers K, Paver CR, Smolyar I (2018). World Ocean Atlas 2018, Volume 1: Temperature. A. Mishonov Technical Ed.; NOAA Atlas NESDIS 81, 52pp.</p>
<p>Nychka D, Furrer R, Paige J, Sain S (2021). “fields: Tools for spatial data.” R package version 13.3, &lt;URL: <a href="https://github.com/dnychka/fieldsRPackage" class="external-link uri">https://github.com/dnychka/fieldsRPackage</a>&gt;.</p>
<p>R Core Team (2017). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="external-link uri">https://www.R-project.org/</a>.</p>
<p>Valdes PJ, Armstrong E, Badger MPS, Bradshaw CD, Bragg F, Crucifix M, Davies-Barnard T, Day JJ, Farnsworth A, Gordon C, Hopcroft PO, Kennedy AT, Lord NS, Lunt DJ, Marzocchi A, Parry LM, Pope V, Roberts WHG, Stone EJ, … Williams JHT. (2017). The BRIDGE HadCM3 family of climate models: <a href="mailto:HadCM3@Bristol" class="email">HadCM3@Bristol</a> v1.0. Geoscientific Model Development, 10(10), 3715–3743. <a href="https://doi.org/10.5194/gmd-10-3715-2017" class="external-link uri">https://doi.org/10.5194/gmd-10-3715-2017</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hannah L. Owens, Carsten Rahbek.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
