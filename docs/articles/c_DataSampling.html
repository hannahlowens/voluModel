<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. Environmental Data Sampling • voluModel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3. Environmental Data Sampling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">voluModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_Introduction.html">1. Introduction to `voluModel`</a>
    </li>
    <li>
      <a href="../articles/b_RasterProcessing.html">2. Processing Raster Data</a>
    </li>
    <li>
      <a href="../articles/c_DataSampling.html">3. Environmental Data Sampling</a>
    </li>
    <li>
      <a href="../articles/d_Visualization.html">4. Visualization Tools</a>
    </li>
    <li>
      <a href="../articles/e_GLMWorkflow.html">5. 3D Niche Modeling with the GLM Algorithm</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hannahlowens/voluModel/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3. Environmental Data Sampling</h1>
                        <h4 data-toc-skip class="author">Hannah L.
Owens</h4>
                        <h4 data-toc-skip class="author">Carsten
Rahbek</h4>
            
            <h4 data-toc-skip class="date">2024-08-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hannahlowens/voluModel/blob/HEAD/vignettes/c_DataSampling.Rmd" class="external-link"><code>vignettes/c_DataSampling.Rmd</code></a></small>
      <div class="hidden name"><code>c_DataSampling.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>As stated in the <a href="https://hannahlowens.github.io/voluModel/articles/a_Introduction.html" class="external-link">introduction
to this package</a>, one of the key contributions of
<code>voluModel</code> is the way it handles the extraction of
environmental data for niche modeling. Specifically, environmental data
at presences, absences, pseudoabsences, and/or background points can be
extracted from environmental data multi-layer <code>SpatRaster</code>
objects based on depth in addition to horizontal coordinates. Another
useful tool provided with <code>voluModel</code> is
<code><a href="../reference/marineBackground.html">marineBackground()</a></code>, which helps the user generate training
regions from which background or pseudoabsence data are drawn. This is
where we will start, so let’s get into it.</p>
<p>Here are the packages you will need.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hannahlowens.github.io/voluModel/" class="external-link">voluModel</a></span><span class="op">)</span> <span class="co"># Because of course</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># For fancy plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ptitle/rangeBuilder" class="external-link">rangeBuilder</a></span><span class="op">)</span> <span class="co"># To compare marineBackground to getDynamicAlphaHull</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># To filter data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span> <span class="co"># Now being transitioned in</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span> <span class="co"># Now being transitioned in</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="d-data-extraction">3D Data Extraction<a class="anchor" aria-label="anchor" href="#d-data-extraction"></a>
</h2>
<p>First, we will cover how to extract environmental data from a
multi-layer <code>SpatRaster</code> object using 3D occurrence
coordinates. The species occurrences I will use are <em>Steindachneria
argentea</em>, Luminous Hake, data downloaded via R (R Core Team, 2020)
from GBIF (Chamberlain <em>et al.</em>, 2021; Chamberlain and Boettiger,
2017) and OBIS (Provoost and Bosch, 2019) via <code>occCite</code>
(Owens <em>et al.</em>, 2021).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get points</span></span>
<span><span class="va">occs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Steindachneria_argentea.csv"</span>, </span>
<span>                             package<span class="op">=</span><span class="st">'voluModel'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="va">occs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">decimalLongitude</span>, <span class="va">decimalLatitude</span>, <span class="va">depth</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">depth</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
<p><img src="c_DataSampling_files/figure-html/occurrence%20dataset%20plotting%20code-1.png"><!-- --></p>
<p>The environmental dataset I will use as an example is temperature
(Locarnini <em>et al.</em>, 2018) from the World Ocean Atlas (WOA;
Garcia <em>et al.</em>, 2019). I have chosen to focus on temperature for
simple illustrative purposes–we recommend you explore additional
variables from the World Ocean Atlas and other sources. These data are
supplied by the World Ocean Atlas as point shapefiles; the version
supplied here has been cropped between -110 and -40 longitude and
between -5 and 50 latitude to make it more memory-efficient.</p>
<p>This chunk of code loads the example data shapefile, which results in
a <code>SpatVector</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Temperature</span></span>
<span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/woa18_decav_t00mn01_cropped.zip"</span>, </span>
<span>                  package <span class="op">=</span> <span class="st">"voluModel"</span><span class="op">)</span>,</span>
<span>      exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/temperature"</span><span class="op">)</span>, junkpaths <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">"/temperature/woa18_decav_t00mn01_cropped.shp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Looking at the dataset</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SURFACE    d5M   d10M   d15M   d20M   d25M   d30M   d35M   d40M   d45M   d50M</span></span>
<span><span class="co">## 1  23.514 23.266 22.969 22.373 21.832 21.320 20.839 20.309 19.780 19.264 18.715</span></span>
<span><span class="co">## 2  23.542 23.222 22.915 22.430 21.938 21.343 20.747 20.182 19.584 18.984 18.394</span></span>
<span><span class="co">## 3  23.575 23.392 22.919 22.318 21.766 21.117 20.531 19.860 19.266 18.673 18.161</span></span>
<span><span class="co">## 4  23.204 22.979 22.559 22.057 21.401 20.651 19.978 19.433 18.835 18.247 17.691</span></span>
<span><span class="co">## 5  23.451 23.125 22.726 22.134 21.520 20.828 20.128 19.472 18.875 18.353 17.875</span></span>
<span><span class="co">## 6  23.261 22.968 22.559 22.052 21.528 20.945 20.337 19.759 19.198 18.669 18.162</span></span>
<span><span class="co">##     d55M   d60M   d65M   d70M   d75M   d80M   d85M   d90M   d95M  d100M  d125M</span></span>
<span><span class="co">## 1 18.164 17.671 17.179 16.743 16.284 15.861 15.622 15.217 14.949 14.767 14.020</span></span>
<span><span class="co">## 2 17.843 17.343 16.906 16.497 16.113 15.800 15.488 15.187 14.927 14.720 13.958</span></span>
<span><span class="co">## 3 17.675 17.174 16.689 16.236 15.919 15.619 15.391 15.165 14.931 14.699 13.993</span></span>
<span><span class="co">## 4 17.177 16.744 16.395 16.074 15.633 15.361 15.172 14.891 14.735 14.556 13.907</span></span>
<span><span class="co">## 5 17.425 16.966 16.536 16.184 15.881 15.588 15.335 15.110 14.875 14.686 14.084</span></span>
<span><span class="co">## 6 17.727 17.306 16.856 16.491 16.135 15.794 15.530 15.219 15.031 14.822 14.159</span></span>
<span><span class="co">##    d150M  d175M  d200M  d225M  d250M  d275M  d300M  d325M  d350M  d375M d400M</span></span>
<span><span class="co">## 1 13.552 13.277 13.096 12.912 12.678 12.306 11.736 11.055 10.482  9.987 9.504</span></span>
<span><span class="co">## 2 13.598 13.302 13.106 12.928 12.667 12.272 11.675 11.060 10.469  9.908 9.476</span></span>
<span><span class="co">## 3 13.574 13.328 13.123 12.928 12.693 12.278 11.729 11.155 10.538  9.984 9.504</span></span>
<span><span class="co">## 4 13.528 13.305 13.117 12.926 12.655 12.275 11.745 11.064 10.454  9.927 9.559</span></span>
<span><span class="co">## 5 13.720 13.465 13.216 13.032 12.682 12.247 11.732 11.089 10.423  9.892 9.668</span></span>
<span><span class="co">## 6 13.757 13.515 13.299 13.123 12.759 12.287 11.760 11.087 10.540 10.019 9.684</span></span>
<span><span class="co">##   d425M d450M d475M d500M d550M d600M d650M d700M d750M d800M d850M d900M d950M</span></span>
<span><span class="co">## 1 9.061 8.696 8.413 8.119 7.570 7.117 6.676 6.241 5.894 5.618 5.313 5.062 4.828</span></span>
<span><span class="co">## 2 9.071 8.712 8.431 8.134 7.621 7.136 6.644 6.255 5.891 5.574 5.262 4.994 4.787</span></span>
<span><span class="co">## 3 9.093 8.765 8.442 8.101 7.620 7.180 6.687 6.267 5.875 5.566 5.293 5.052 4.811</span></span>
<span><span class="co">## 4 9.118 8.732 8.421 8.182 7.663 7.176 6.712 6.270 5.912 5.598 5.330 5.094 4.844</span></span>
<span><span class="co">## 5 9.063 8.720 8.404 8.156 7.593 7.114 6.662 6.249 5.869 5.553 5.301 5.038 4.781</span></span>
<span><span class="co">## 6 9.142 8.805 8.477 8.217 7.654 7.170 6.760 6.335 5.927 5.590 5.327 5.088 4.847</span></span>
<span><span class="co">##   d1000M d1050M d1100M d1150M d1200M d1250M d1300M d1350M d1400M d1450M d1500M</span></span>
<span><span class="co">## 1  4.618  4.410  4.223  4.054  3.868  3.727  3.563  3.410  3.278  3.144  3.050</span></span>
<span><span class="co">## 2  4.562  4.379  4.207  4.048  3.876  3.731  3.560  3.428  3.297  3.167  3.040</span></span>
<span><span class="co">## 3  4.571  4.397  4.218  4.048  3.896  3.737  3.592  3.440  3.286  3.149  3.044</span></span>
<span><span class="co">## 4  4.614  4.415  4.219  4.048  3.899  3.743  3.581  3.426  3.279  3.153  3.049</span></span>
<span><span class="co">## 5  4.587  4.395  4.233  4.062  3.911  3.727  3.555  3.404  3.279  3.150  3.045</span></span>
<span><span class="co">## 6  4.617  4.441  4.243  4.060  3.905  3.747  3.573  3.424  3.294  3.172  3.050</span></span>
<span><span class="co">##   d1550M d1600M d1650M d1700M d1750M d1800M d1850M d1900M d1950M d2000M d2100M</span></span>
<span><span class="co">## 1  2.949  2.858  2.769  2.692  2.618  2.540  2.470  2.406  2.329  2.320  2.227</span></span>
<span><span class="co">## 2  2.950  2.856  2.765  2.686  2.606  2.527  2.455  2.376  2.308    NaN    NaN</span></span>
<span><span class="co">## 3  2.946  2.860  2.759  2.682  2.605  2.531  2.456  2.392  2.326  2.351  2.193</span></span>
<span><span class="co">## 4  2.938  2.843  2.754  2.675  2.602  2.528  2.463  2.398  2.335  2.223  2.130</span></span>
<span><span class="co">## 5  2.936  2.845  2.760  2.666  2.579  2.513  2.453  2.395  2.340  2.254  2.165</span></span>
<span><span class="co">## 6  2.946  2.845  2.758  2.679  2.600  2.526  2.459  2.397  2.338  2.276  2.165</span></span>
<span><span class="co">##   d2200M d2300M d2400M d2500M d2600M d2700M d2800M d2900M d3000M d3100M d3200M</span></span>
<span><span class="co">## 1  2.147  2.075  2.012  1.960  1.908  1.864  1.826  1.794  1.770    NaN    NaN</span></span>
<span><span class="co">## 2    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 3  2.081  1.993  1.921  1.862  1.813  1.777  1.753  1.754  1.755    NaN    NaN</span></span>
<span><span class="co">## 4  2.046  1.962  1.891  1.834  1.789  1.795  1.745    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 5  2.047  1.985  1.921  1.870  1.812  1.769  1.746  1.743  1.753  1.766    NaN</span></span>
<span><span class="co">## 6  2.076  2.003  1.936  1.886  1.843  1.796  1.761  1.751  1.753  1.759   1.78</span></span>
<span><span class="co">##   d3300M d3400M d3500M d3600M d3700M d3800M d3900M d4000M d4100M d4200M d4300M</span></span>
<span><span class="co">## 1    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 2    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 3    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 4    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 5    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 6    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">##   d4400M d4500M d4600M d4700M d4800M d4900M d5000M d5100M d5200M d5300M d5400M</span></span>
<span><span class="co">## 1    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 2    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 3    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 4    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 5    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">## 6    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN</span></span>
<span><span class="co">##   d5500M</span></span>
<span><span class="co">## 1    NaN</span></span>
<span><span class="co">## 2    NaN</span></span>
<span><span class="co">## 3    NaN</span></span>
<span><span class="co">## 4    NaN</span></span>
<span><span class="co">## 5    NaN</span></span>
<span><span class="co">## 6    NaN</span></span></code></pre>
<p>As you can see, each point in the <code>SpatVector</code> is a line
in the associated <code>data.frame</code>; each column is a depth layer
at that point–“d5M” translates to “5 meters deep”. For more details on
how to process environmental data, see <a href="https://hannahlowens.github.io/voluModel/articles/b_RasterProcessing.html" class="external-link">the
raster data tutorial</a>. This next chunk converts the
<code>SpatVector</code> to a multi-layer <code>SpatRaster</code>; the
layers of the multi-layer <code>SpatRaster</code> are then named the
same as the column names of the <code>SpatVector</code>. I strip the “d”
and “M” from the column names so they are a little easier to use as
depth coordinates. Note that <code>R</code> will not allow the raster
names to be numeric, so it adds an “X” to the beginning of each column
name. Don’t worry about this–<code>voluModel</code> can handle numbers
preceded by “X”s without user intervention.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a SpatRaster vector</span></span>
<span><span class="va">template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerPointRasterTemplate.html">centerPointRasterTemplate</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span></span>
<span><span class="va">tempTerVal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rasterize.html" class="external-link">rasterize</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">template</span>, field <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get names of depths</span></span>
<span><span class="va">envtNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[d,M]"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">envtNames</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"0"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tempTerVal</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">envtNames</span></span>
<span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="va">tempTerVal</span></span>
<span></span>
<span><span class="co"># Here's a sampling of depth plots from the 102 depth layers available</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="c_DataSampling_files/figure-html/temperature%20to%20compatible%20RasterBrick-1.png"><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tempTerVal</span><span class="op">)</span></span></code></pre></div>
<p>At this point, you may have noticed a message popping up about which
columns <code>voluModel</code> is interpreting as coordinates.
<code>voluModel</code> is fairly flexible in how the coordinate columns
are named, and it relies on names instead of column position to
interpret x, y, and z (or latitude, longitude, and depth) coordinates.
We do this to make <code>voluModel</code> as flexible as possible to a
diversity of input formats, although English is the only supported
language at the moment. Here are some examples of names that work.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occsTest</span> <span class="op">&lt;-</span> <span class="va">occurrences</span><span class="op">[</span><span class="fl">19</span><span class="op">:</span><span class="fl">24</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="../reference/xyzSample.html">xyzSample</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">occsTest</span>, envBrick <span class="op">=</span> <span class="va">temperature</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using decimalLongitude, decimalLatitude, and depth</span></span>
<span><span class="co">##  as x, y, and z coordinates, respectively.</span></span></code></pre>
<pre><code><span><span class="co">## [1] 25.770 15.091     NA  9.137     NA     NA</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">occsTest</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/xyzSample.html">xyzSample</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">occsTest</span>, envBrick <span class="op">=</span> <span class="va">temperature</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using x, y, and z</span></span>
<span><span class="co">##  as x, y, and z coordinates, respectively.</span></span></code></pre>
<pre><code><span><span class="co">## [1] 25.770 15.091     NA  9.137     NA     NA</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">occsTest</span><span class="op">)</span></span></code></pre></div>
<p>One optional step in a niche modeling workflow is to down-sample
occurrence data to the same resolution as the environmental data. We do
this to avoid over-fitting the model due to biased sampling. The next
chunk of code downsamples occurrence points so that there is only one
per voxel (i.e. 3D pixel) of environmental data. It does this by looping
through each layer of the multi-layer <code>SpatRaster</code>, selecting
the occurrence points with depths closest to the depths represented by
the corresponding layer in the <code>SpatRaster</code> vector. I then
downsample these points using <code>voluModel</code>’s
<code><a href="../reference/downsample.html">downsample()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gets the layer index for each occurrence by matching to depth</span></span>
<span><span class="va">layerNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">occurrences</span><span class="op">$</span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">$</span><span class="va">depth</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">layerNames</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">$</span><span class="va">index</span><span class="op">)</span></span>
<span><span class="va">downsampledOccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">indices</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tempPoints</span> <span class="op">&lt;-</span> <span class="va">occurrences</span><span class="op">[</span><span class="va">occurrences</span><span class="op">$</span><span class="va">index</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span></span>
<span>  <span class="va">tempPoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/downsample.html">downsample</a></span><span class="op">(</span><span class="va">tempPoints</span>, <span class="va">temperature</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">tempPoints</span><span class="op">$</span><span class="va">depth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">layerNames</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tempPoints</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">downsampledOccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">downsampledOccs</span>, <span class="va">tempPoints</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="va">downsampledOccs</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   decimalLongitude decimalLatitude depth</span></span>
<span><span class="co">## 1            -54.5             7.5   450</span></span>
<span><span class="co">## 2            -82.5            12.5   450</span></span>
<span><span class="co">## 3            -93.5            19.5   450</span></span>
<span><span class="co">## 4            -97.5            22.5   450</span></span>
<span><span class="co">## 5            -82.5            23.5   450</span></span>
<span><span class="co">## 6            -89.5            23.5   450</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Original number of points: "</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">occs</span><span class="op">)</span>, <span class="st">"; number of downsampled occs: "</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Original number of points: 301; number of downsampled occs: 71"</span></span></code></pre>
<p>The resampled points returned by <code><a href="../reference/downsample.html">downsample()</a></code> are
horizontally centered in each voxel. The red dots in the plot show
occurrences from the original dataset; the orange dots show the
downsampled dataset. Not all of the orange dots may be visible
underneath the red dots.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pointCompMap.html">pointCompMap</a></span><span class="op">(</span>occs1 <span class="op">=</span> <span class="va">occs</span>, occs2 <span class="op">=</span> <span class="va">occurrences</span>, </span>
<span>             occs1Name <span class="op">=</span> <span class="st">"original"</span>, occs2Name <span class="op">=</span> <span class="st">"cleaned"</span>, </span>
<span>             spName <span class="op">=</span> <span class="st">"Steindachneria argentea"</span>, </span>
<span>             land <span class="op">=</span> <span class="va">land</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="c_DataSampling_files/figure-html/plot%20downsample-1.png"><!-- --></p>
<p>At this point, we can demonstrate one of the key contributions of
<code>voluModel</code>– an improvement in how the environmental data are
extracted at species’ occurrences. <code>voluModel</code> samples
environmental conditions at the depth where each record was located,
instead of extrapolating to surface or bottom conditions. Finally, we
add a column called “response” and fill it by repeating “1”, to signify
that these occurrences should be interpreted as presences for the
purposes of modeling.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraction</span></span>
<span><span class="va">occurrences</span><span class="op">$</span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xyzSample.html">xyzSample</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">occurrences</span>, envBrick <span class="op">=</span> <span class="va">temperature</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using decimalLongitude, decimalLatitude, and depth</span></span>
<span><span class="co">##  as x, y, and z coordinates, respectively.</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add "response" column for modeling</span></span>
<span><span class="va">occurrences</span><span class="op">$</span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="va">occurrences</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    decimalLongitude decimalLatitude depth temperature response</span></span>
<span><span class="co">## 3             -93.5            19.5   450       9.137        1</span></span>
<span><span class="co">## 5             -82.5            23.5   450      11.395        1</span></span>
<span><span class="co">## 6             -89.5            23.5   450       9.285        1</span></span>
<span><span class="co">## 7             -84.5            26.5   450       9.145        1</span></span>
<span><span class="co">## 9             -91.5            27.5   450       9.091        1</span></span>
<span><span class="co">## 15            -89.5            28.5    80      20.440        1</span></span></code></pre>
<p>In a “real” modeling scenario, you would extract all your
environmental variables using <code><a href="../reference/xyzSample.html">xyzSample()</a></code>, then add the
response column. Or add the response column first or in the middle. I’m
not the boss of you.</p>
</div>
<div class="section level2">
<h2 id="generating-repeatable-training-regions">Generating Repeatable Training Regions<a class="anchor" aria-label="anchor" href="#generating-repeatable-training-regions"></a>
</h2>
<p>To generate a sample of pseudoabsences and/or background points, it
is important to consider the environments the species of interest can
access (Barve <em>et al.</em>, 2011). There is ample discussion in the
literature on how to best delimit a niche model training region (also
variously called M or the background region), and we will not review the
issue here. In the absence of specific information on species’ dispersal
capabilities, algorithmically generating a repeatable sampling
background from a clear set of rules may be suitable approximation, or a
jumping-off point for hand-curating training regions in a GIS software
of choice.</p>
<p>We designed <code><a href="../reference/marineBackground.html">marineBackground()</a></code> as a wrapper around , a
function provided by the <code>rangeBuilder</code> package
(Davis-Rabosky <em>et al.</em>, 2016) which generates background
sampling regions by fitting an alpha hull polygon around an occurrence
point dataset. Let’s look at how <code><a href="../reference/marineBackground.html">marineBackground()</a></code> (and by
extension <code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code>) fits alpha hull polygons,
based on the cleaned species occurrence data from above.</p>
<p><code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code>, which is run within
<code><a href="../reference/marineBackground.html">marineBackground()</a></code> generates a polygon (or polygons) that
can be used as a training region by fitting an alpha hull (or hulls)
around an occurrence dataset. Alpha is a parameter that controls the
complexity of the polygon(s) that is being fit around the occurrences.
<code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code> adjusts the alpha parameter
iteratively, until it meets criteria the user can set via the arguments
<code>fraction</code>, which is the minimum fraction of occurrences that
must be contained within the polygon(s), <code>partCount</code>, which
is the maximum number of polygons generated to fit the data, and
<code>buff</code>, which is the permissible distance from a point to the
edge of a polyon in meters. <code><a href="../reference/marineBackground.html">marineBackground()</a></code> takes these
and many of the same other arguments as
<code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code>. Here’s how it works.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trainingRegion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marineBackground.html">marineBackground</a></span><span class="op">(</span><span class="va">occurrences</span>, </span>
<span>                                fraction <span class="op">=</span> <span class="fl">1</span>, partCount <span class="op">=</span> <span class="fl">1</span>, buff <span class="op">=</span> <span class="fl">1000000</span>,</span>
<span>                                clipToOcean <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trainingRegion</span>, border <span class="op">=</span> <span class="cn">F</span>, col <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"100% Points, Max 1 Polygon Permitted, 100 km Buffer"</span>,</span>
<span>     axes <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land</span>, col <span class="op">=</span> <span class="st">"black"</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decimalLongitude"</span>, <span class="st">"decimalLatitude"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="alphaHullDemonstration-1.png" width="742"></p>
<p>What parameters you choose to fit the alpha hull will depend on the
biology of the organism you are trying to model (e.g. you may choose a
much smaller buffer for a sessile organism than you would for a highly
vagile migratory species), your data, and the particulars of your study
system and the geography of your study area. You may need to experiment
to find something that looks sensible. If you do not provide a
pre-defined buffer, <code><a href="../reference/marineBackground.html">marineBackground()</a></code> will calculate a
buffer that is the mean of the top and bottom 10% of distances between
points in the dataset.</p>
<p>You may have noticed that the training regions in the above examples
include some areas of the Pacific where the species has not been
observed, and cannot access. This could cause problems if it is used to
train your model. You <em>could</em> delete this area by hand in your
favorite GIS software, OR you could change <code>clipToOcean</code> to
<code>TRUE</code> in <code><a href="../reference/marineBackground.html">marineBackground()</a></code>, and any polygon
fragments that do not contain an occurrence will be deleted
automatically. This is a key difference from
<code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trainingRegion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marineBackground.html">marineBackground</a></span><span class="op">(</span><span class="va">occurrences</span>, </span>
<span>                                   buff <span class="op">=</span> <span class="fl">1000000</span>, </span>
<span>                                   clipToOcean <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trainingRegion</span>, border <span class="op">=</span> <span class="cn">F</span>, col <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"100 km Buffer, Clipped to Occupied Polygon"</span>,</span>
<span>     axes <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land</span>, col <span class="op">=</span> <span class="st">"black"</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decimalLongitude"</span>, <span class="st">"decimalLatitude"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="clipToOceanDemo-1.png" width="742"></p>
<p>The last major difference between <code><a href="../reference/marineBackground.html">marineBackground()</a></code> and
<code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code> is how the functions handle training
regions that are adjacent to the antimeridian (i.e. 180° E or W).
<code><a href="https://rdrr.io/pkg/rangeBuilder/man/getDynamicAlphaHull.html" class="external-link">getDynamicAlphaHull()</a></code> truncates polygons at this line,
which can lead to some strange-looking training areas or fatal errors.
<code><a href="../reference/marineBackground.html">marineBackground()</a></code>, on the other hand, wraps polygons
across the meridian and merges them if they overlap. For this example, I
am going to manipulate the longitudinal coordinates of our Luminous Hake
dataset to generate a quick fictional example.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fictional example occurrences</span></span>
<span><span class="va">pacificOccs</span> <span class="op">&lt;-</span> <span class="va">occurrences</span></span>
<span><span class="va">pacificOccs</span><span class="op">$</span><span class="va">decimalLongitude</span> <span class="op">&lt;-</span> <span class="va">pacificOccs</span><span class="op">$</span><span class="va">decimalLongitude</span> <span class="op">-</span> <span class="fl">100</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pacificOccs</span><span class="op">$</span><span class="va">decimalLongitude</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">pacificOccs</span><span class="op">$</span><span class="va">decimalLongitude</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">180</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">pacificOccs</span><span class="op">$</span><span class="va">decimalLongitude</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pacificOccs</span><span class="op">$</span><span class="va">decimalLongitude</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fl">360</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># marine Background</span></span>
<span><span class="va">pacificTrainingRegion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marineBackground.html">marineBackground</a></span><span class="op">(</span><span class="va">pacificOccs</span>, </span>
<span>                                          fraction <span class="op">=</span> <span class="fl">0.95</span>, partCount <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                                          clipToOcean <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pacificTrainingRegion</span>, border <span class="op">=</span> <span class="cn">F</span>, col <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"marineBackground Antimeridian Wrap"</span>,</span>
<span>     axes <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land</span>, col <span class="op">=</span> <span class="st">"black"</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">pacificOccs</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decimalLongitude"</span>, <span class="st">"decimalLatitude"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="meridianWrapDemo-1.png" width="742"></p>
</div>
<div class="section level2">
<h2 id="background-data-extraction">Background Data Extraction<a class="anchor" aria-label="anchor" href="#background-data-extraction"></a>
</h2>
<p>As discussed above, some modeling methods require the generation of a
sampling region from which training/pseudoabsence/background points are
drawn. The training region should approximately answer the question
“What environments are most likely to have been experienced by Lumious
Hakes?” Our answer to this question for the purposes of this tutorial is
represented in <code>trainingRegion</code>, which we generated above
using <code><a href="../reference/marineBackground.html">marineBackground()</a></code>. Next, we generate 3D training
points within this region using the <code><a href="../reference/mSampling3D.html">mSampling3D()</a></code> function.
The function takes an occurrence <code>data.frame</code>, a multi-layer
<code>SpatRaster</code> that will serve as a template for the resolution
of the training points, a <code>SpatialPolygons</code> object
representing the training region, and, optionally, information on the
range of depths from which the function should sample. If you have
reason to believe the species you are modeling can access depths higher
or lower than those represented by occurrences, you can specify a
maximum and minimum training depth from which to draw occurrence points.
<code><a href="../reference/mSampling3D.html">mSampling3D()</a></code> by default draws training points from the
full depth extent of the supplied multi-layer
<code>SpatRaster</code>.</p>
<p>For this example, I am sampling training points from 50 to 1500
m.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Background</span></span>
<span><span class="va">backgroundVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mSampling3D.html">mSampling3D</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">occurrences</span>, </span>
<span>                              envBrick <span class="op">=</span> <span class="va">temperature</span>, </span>
<span>                              mShp <span class="op">=</span> <span class="va">trainingRegion</span>, </span>
<span>                              depthLimit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">1500</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using decimalLongitude, decimalLatitude, and depth</span></span>
<span><span class="co">##  as x, y, and z coordinates, respectively.</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xyzSample.html">xyzSample</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">backgroundVals</span>, <span class="va">temperature</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using decimalLongitude, decimalLatitude, and depth</span></span>
<span><span class="co">##  as x, y, and z coordinates, respectively.</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Remove incomplete cases</span></span>
<span><span class="va">backgroundVals</span> <span class="op">&lt;-</span> <span class="va">backgroundVals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Once the points are sampled, we add a column called “response” and
fill it by repeating “0”, to signify that these occurrences should be
interpreted as absences for the purposes of modeling.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add "response" column for modeling</span></span>
<span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, times <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    decimalLongitude decimalLatitude depth temperature response</span></span>
<span><span class="co">## 82            -68.5            43.5    50       6.473        0</span></span>
<span><span class="co">## 83            -67.5            43.5    50       6.669        0</span></span>
<span><span class="co">## 84            -66.5            43.5    50       6.779        0</span></span>
<span><span class="co">## 86            -64.5            43.5    50       3.679        0</span></span>
<span><span class="co">## 87            -63.5            43.5    50       4.003        0</span></span>
<span><span class="co">## 88            -62.5            43.5    50       5.038        0</span></span></code></pre>
<p>It is important to note that this background data represents EVERY
voxel within the training region that is not occupied by observances.
Depending on your study design and the modeling algorithm you are using,
these data will need to be subsampled. You could choose a random sample,
select points based on geography, or any number of other strategies.
Below is just one example–weighting the background points by their
environmental dissimilarity to the Luminous Hake occurrence points. This
manner of downsampling may be appropriate for modeling methods that
interpret training points as pseudoabsences, such as generalized linear
modeling, but will lead to overfit models when using algorithms like
Maxent.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample background points weighted by distance from mean of occurrence temperatures</span></span>
<span><span class="va">meanTemp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">[</span>,<span class="st">"temperature"</span><span class="op">]</span> <span class="op">-</span> <span class="va">meanTemp</span><span class="op">)</span></span>
<span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">sampleWeight</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">distance</span> <span class="op">-</span> </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span> <span class="op">-</span></span>
<span>                                                                  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sampleForAbsence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">)</span>, </span>
<span>                           size <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>                           prob <span class="op">=</span> <span class="va">backgroundVals</span><span class="op">$</span><span class="va">backgroundVals</span><span class="op">)</span></span>
<span><span class="va">backgroundVals</span> <span class="op">&lt;-</span> <span class="va">backgroundVals</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">sampleForAbsence</span>, </span>
<span>                                       <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">backgroundVals</span><span class="op">$</span><span class="va">response</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unite datasets and see how things look</span></span>
<span><span class="va">dataForModeling</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">occurrences</span>, <span class="va">backgroundVals</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dataForModeling</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, fill <span class="op">=</span> <span class="va">response</span>, color <span class="op">=</span> <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#999999"</span>, <span class="st">"#E69F00"</span><span class="op">)</span>, </span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pseudoabsence"</span>, <span class="st">"Presence"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#999999"</span>, <span class="st">"#E69F00"</span><span class="op">)</span>, </span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pseudoabsence"</span>, <span class="st">"Presence"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Temperature Sampling Density,\nOccurrences vs. Pseudoabsences"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Temperature (C)"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="c_DataSampling_files/figure-html/glm%20data%20prep%20part%202-1.png"><!-- --></p>
<p>For a more complex, multivariate example of environmental
dissimilarity weighting, refer to the <a href="https://hannahlowens.github.io/voluModel/articles/e_GLMWorkflow.html" class="external-link">GLM
workflow</a>.</p>
</div>
<div class="section level2">
<h2 id="tidying-up">Tidying up<a class="anchor" aria-label="anchor" href="#tidying-up"></a>
</h2>
<p>Last, we need to close the temporary directory we opened when we
opened the data.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">td</span>, recursive <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bakis Y (2021): TU_Fish. v1.1. No organization. Dataset/Occurrence.
<a href="https://fishair.org/ipt/resource?r=tu_fish&amp;v=1.1" class="external-link uri">https://fishair.org/ipt/resource?r=tu_fish&amp;v=1.1</a>
Accessed via OBIS on 2020-11-04.</p>
<p>Bentley A (2022). KUBI Ichthyology Collection. Version 17.80.
University of Kansas Biodiversity Institute. DOI: 10.15468/mgjasg.
Accessed via GBIF on 2020-10-13.</p>
<p>Bentley A (2022). KUBI Ichthyology Tissue Collection. Version 18.68.
University of Kansas Biodiversity Institute. DOI: 10.15468/jmsnwg.
Accessed via GBIF on 2020-10-13.</p>
<p>Buckup P A (2022). Coleção Ictiológica (MNRJ), Museu Nacional (MN),
Universidade Federal do Rio de Janeiro(UFRJ). Version 157.1487. Museu
Nacional / UFRJ. DOI: 10.15468/lluzfl. Accessed via GBIF on
2020-10-13.</p>
<p>Catania D, Fong J (2022). CAS Ichthyology (ICH). Version 150.300.
California Academy of Sciences. DOI: 10.15468/efh2ib. Accessed via GBIF
on 2020-10-13.</p>
<p>Chakrabarty P (2019). LSUMZ (LSU MNS) Fishes Collection. Version 2.2.
Louisiana State University Museum of Natural Science. DOI:
10.15468/gbnym3. Accessed via GBIF on 2020-10-13.</p>
<p>Chamberlain S, Barve V, Mcglinn D, Oldoni D, Desmet P, Geffert L, Ram
K (2021). rgbif: Interface to the Global Biodiversity Information
Facility API. R package version 3.6.0, <a href="https://CRAN.R-project.org/package=rgbif" class="external-link uri">https://CRAN.R-project.org/package=rgbif</a>.</p>
<p>Chamberlain S, Boettiger C (2017). “R Python, and Ruby clients for
GBIF species occurrence data.” PeerJ PrePrints. DOI:
10.7287/peerj.preprints.3304v1.</p>
<p>Davis-Rabosky AR, Cox CL, Rabosky DL, Title PO, Holmes IA, Feldman A,
McGuire JA (2016). Coral snakes predict the evolution of mimicry across
New World snakes. <em>Nature Communications</em> 7:11484. DOI:
10.1038/ncomms11484</p>
<p>Espinosa Pérez H, Comisión nacional para el conocimiento y uso de la
biodiversidad C (2021). Computarización de la Colección Nacional de
Peces del Instituto de Biología UNAM. Version 1.9. Comisión nacional
para el conocimiento y uso de la biodiversidad. DOI: 10.15468/zb2odl.
Accessed via GBIF on 2020-10-13.</p>
<p>Frable B (2019). SIO Marine Vertebrate Collection. Version 1.7.
Scripps Institution of Oceanography. DOI: 10.15468/ad1ovc. Accessed via
GBIF on 2020-10-13.</p>
<p>Fishnet2 Portal, <a href="http://www.fishnet2.net" class="external-link uri">http://www.fishnet2.net</a>, Accessed via OBIS on
2020-11-04.</p>
<p>Froese, R. and D. Pauly. Editors. 2020. FishBase. World Wide Web
electronic publication. www.fishbase.org, version (xx/200x). Accessed
via OBIS on 2020-11-04.</p>
<p>Gall L (2021). Vertebrate Zoology Division - Ichthyology, Yale
Peabody Museum. Yale University Peabody Museum. DOI: 10.15468/mgyhok.
Accessed via GBIF on 2020-10-13.</p>
<p>García, CB, and Duarte, LO, ‘Columbian Caribbean Sea’, in J.H.
Nicholls (comp.) HMAP Data Pages <a href="https://oceanspast.org/hmap_db.php" class="external-link uri">https://oceanspast.org/hmap_db.php</a> Accessed via OBIS on
2020-11-04.</p>
<p>Garcia HE, Weathers K, Paver CR, Smolyar I, Boyer TP, Locarnini RA,
Zweng MM, Mishonov AV, Baranova OK, Seidov D, Reagan JR (2018). World
Ocean Atlas 2018, Volume 3: Dissolved Oxygen, Apparent Oxygen
Utilization, and Oxygen Saturation. A Mishonov Technical Ed.; NOAA Atlas
NESDIS 83, 38pp.</p>
<p>GBIF.org (24 September 2020) GBIF Occurrence Download DOI:
10.15468/dl.efuutj.</p>
<p>Grant S, McMahan C (2020). Field Museum of Natural History (Zoology)
Fish Collection. Version 13.12. Field Museum. DOI: 10.15468/alz7wu.
Accessed via GBIF on 2020-10-13.</p>
<p>Harvard University M, Morris P J (2022). Museum of Comparative
Zoology, Harvard University. Version 162.296. Museum of Comparative
Zoology, Harvard University. DOI: 10.15468/p5rupv. Accessed via GBIF on
2020-10-13.</p>
<p>Hendrickson D A, Cohen A E, Casarez M J (2022). University of Texas,
Biodiversity Center, Ichthyology Collection (TNHCi). Version 5.175.
University of Texas at Austin, Biodiversity Collections. DOI:
10.15468/h8gxdr. Accessed via GBIF on 2020-10-13.</p>
<p>INVEMAR (2022). SIBM en línea: Sistema de Información sobre
Biodiversidad Marina. Santa Marta: Instituto de investigaciones Marinas
y Costeras José Benito Vives de Andréis,. <a href="http://www.invemar.org.co/siam/sibm/index.htm" class="external-link uri">http://www.invemar.org.co/siam/sibm/index.htm</a> Accessed
via OBIS on 2020-11-04.</p>
<p>Locarnini RA, Mishonov AV, Baranova OK, Boyer TP, Zweng MM, Garcia
HE, Reagan JR, Seidov D, Weathers K, Paver CR, Smolyar I (2018). World
Ocean Atlas 2018, Volume 1: Temperature. A. Mishonov Technical Ed.; NOAA
Atlas NESDIS 81, 52pp.</p>
<p>McLean, M.W. (2014). Straightforward Bibliography Management in R
Using the RefManager Package. NA, NA. <a href="https://arxiv.org/abs/1403.2036" class="external-link uri">https://arxiv.org/abs/1403.2036</a>.</p>
<p>McLean, M.W. (2017). RefManageR: Import and Manage BibTeX and
BibLaTeX References in R. The Journal of Open Source Software.</p>
<p>Mertz W (2021). LACM Vertebrate Collection. Version 18.9. Natural
History Museum of Los Angeles County. DOI: 10.15468/77rmwd. Accessed via
GBIF on 2020-10-13.</p>
<p>Nakae M, Shinohara G (2018). Fish collection of National Museum of
Nature and Science. National Museum of Nature and Science, Japan.
Occurrence dataset DOI: 10.15468/w3dzv1 accessed via GBIF.org on
yyyy-mm-dd. Accessed via OBIS on 2020-11-04.</p>
<p>Natural History Museum (2021). Natural History Museum (London)
Collection Specimens. DOI: 10.5519/0002965. Accessed via GBIF on
2020-10-13.</p>
<p>National Museum of Natural History, Smithsonian Institution NMNH
Fishes Collection Database (2007). National Museum of Natural History,
Smithsonian Institution, 10th and Constitution Ave. N.W., Washington, DC
20560-0193. Accessed via OBIS on 2020-11-04.</p>
<p>Norén M, Shah M (2017). Fishbase. FishBase. DOI: 10.15468/wk3zk7.
Accessed via GBIF on 2020-10-13.</p>
<p>Norton B, Hogue G (2021). NCSM Ichthyology Collection. Version 22.8.
North Carolina State Museum of Natural Sciences. DOI: 10.36102/dwc.1.
Accessed via GBIF on 2020-10-13.</p>
<p>Nychka D, Furrer R, Paige J, Sain S (2021). “fields: Tools for
spatial data.” R package version 13.3. <a href="https://github.com/dnychka/fieldsRPackage" class="external-link uri">https://github.com/dnychka/fieldsRPackage</a>.</p>
<p>Orrell T, Informatics Office (2021). NMNH Extant Specimen Records
(USNM, US). Version 1.49. National Museum of Natural History,
Smithsonian Institution. DOI: 10.15468/hnhrg3. Accessed via GBIF on
2020-10-13.</p>
<p>Owens H, Merow C, Maitner B, Kass J, Barve V, Guralnick R (2021).
occCite: Querying and Managing Large Biodiversity Occurrence Datasets.
doi: 10.5281/zenodo.4726676, R package version 0.4.9.9000, <a href="https://CRAN.R-project.org/package=occCite" class="external-link uri">https://CRAN.R-project.org/package=occCite</a>.</p>
<p>Prestridge H (2021). Biodiversity Research and Teaching Collections -
TCWC Vertebrates. Version 9.4. Texas A&amp;M University Biodiversity
Research and Teaching Collections. DOI: 10.15468/szomia. Accessed via
GBIF on 2020-10-13.</p>
<p>Provoost P, Bosch S (2019). “robis: R Client to access data from the
OBIS API.” Ocean Biogeographic Information System. Intergovernmental
Oceanographic Commission of UNESCO. R package version 2.1.8, <a href="https://cran.r-project.org/package=robis" class="external-link uri">https://cran.r-project.org/package=robis</a>.</p>
<p>Pugh W (2021). UAIC Ichthyological Collection. Version 3.3.
University of Alabama Biodiversity and Systematics. DOI:
10.15468/a2laag. Accessed via GBIF on 2020-10-13.</p>
<p>R Core Team (2017). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/" class="external-link uri">https://www.R-project.org/</a>.</p>
<p>Robins R (2021). UF FLMNH Ichthyology. Version 117.342. Florida
Museum of Natural History. DOI: 10.15468/8mjsel. Accessed via GBIF on
2020-10-13.</p>
<p>Tavera L, Tavera M. L (2021). Biodiversidad de los recursos marinos y
costeros entre Cartagena y el Golfo de Urabá, Caribe colombiano. Version
2.4. Instituto de Investigaciones Marinas y Costeras - Invemar. DOI:
10.15472/d2jusp. Accessed via GBIF on 2020-10-13.</p>
<p>UNIBIO, IBUNAM (2020). CNPE/Coleccion Nacional de Peces. DOI:
10.15468/o5d48z. Accessed via GBIF on 2020-10-13.</p>
<p>Wagner M (2017). MMNS Ichthyology Collection. Mississippi Museum of
Natural Science. DOI: 10.15468/4c3qeq. Accessed via GBIF on
2020-10-13.</p>
<p>Werneke D (2019). AUM Fish Collection. Version 8.1. Auburn University
Museum. DOI: 10.15468/dm3oyz. Accessed via GBIF on 2020-10-13.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hannah L. Owens, Carsten Rahbek.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
